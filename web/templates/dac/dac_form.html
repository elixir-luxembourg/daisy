{% extends 'layout.html' %}

{% block title %}DAC - Add{% endblock %}

{% block content %}
    <div class="jumbotron mt-4 {% block jumbotron_class %}{% endblock %}">
        <h1 class="display-4">{% block content_title %}DACs{% endblock %}</h1>
    </div>
    <div class="card">
        <div class="card-body">
            <h2 class="card-title">{% block card_title %}Add DAC{% endblock %}</h2>
            <div class="card-text">
                {% include '_includes/forms.html' %}
            </div>
        </div>
    </div>
{% endblock %}

{% block js %}
    <script>
        $('#id_projects').change(function() {
            var projectId = $(this).val();
            url = '/ajax/contracts';
            if (projectId) {
                url += '?projectId=' + projectId;
            }
            $.get(url, function(data) {
                var $contract = $('#id_contract');
                $contract.empty();
                if (!data.contracts || data.contracts.length === 0) {
                    $contract.append($('<option>', {value: '', text: 'No contracts available'}));
                    return;
                }
                $contract.append($('<option>', {value: '', text: 'Select contract'}));
                $.each(data.contracts, function(idx, contract) {
                    $contract.append($('<option>', {value: contract.id, text: contract.name}));
                });
            });
        });
    </script>
{% endblock %}
